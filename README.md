# ch-encode
Clickhouse typesafe RowBinary insert data encoder generator.

## The problem
* Tables can be wide and thus generating proper INSERT statements is a source of errors itself.
* Proper data buffering on INSERT statements is a bit tricky

## Solution
* Take Clickhouse table. Map it into the function call (column → function parameter)
* Function generates binary data in Clickhouse RowBinary format. Buffering became trivial (special bufferer is needed anyway - 
function call output which represents a table record must not be splitted)

## Problems raised
* Scheme desync - this can be detected with autogenerated tests, where the state of table scheme will be stored and then compared to current scheme

## Bonuses
* Testing mock objects can be generated as well.


# How to use
```bash
go get github.com/DenisCheremisov/ch-encode
```
then
```bash
ch-encode table1 table2 … tableN
```
will generated N packages in the current folder with autogenerated encoders and desync tests

